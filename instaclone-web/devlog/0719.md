# 🥂 DEVLOG 7/19



### #10.5 Forms in React

```js
// Login.js
function Login() {
    const [username, setusername] = useState("");
    const onUsernameChange = (event) => {
        setusername(event.target.value);
    }
    
    return (
    ...
    <form>
    	<Input
    		onChange={onUsernameChange}
			value = {username}
			... />
	</form>
)
}
```

- handleSubmit

```js
const handleSubmit = (event) => {
        event.preventDefault();
        if (username === "") {
            setUsernameError("Not empty plz")
        }
        if (username.length < 10) {
            setUsernameError("too short");
        }
        console.log(username);
    }

...
 <form onSubmit={handleSubmit}>
```



### #10.6 Helmet Component

- 타이틀(탭 제목) 바꾸기

```js
// Login.js
<Helmet>
	<title>Login | Instaclone</title>
</Helmet>
```

- helmet component는 helmet provider 안에 있어야 한다

```js
// App.js
// HelmetProvider로 전부 감싸기
function App() {
    ...
    return(
    	<HelmetProvider>
        	..
        </HelmetProvider>
    )
}
```

- PageTitle을 컴포넌트로 만들기

```js
// PageTitle.js
function PageTitle({ title }) {
    return <Helmet><title>{title} | Instaclone</title></Helmet>
}
```



### #10.7 React Hook Form

-  react hook form 사용해서 폼 만들기

1. **모든 것이 단 한개의 hook(useForm hook) 으로부터 나온다는 것**
2.  **register**
   
   - state와 setState, onChange function을 만드는 모든 과정을 대신함
   
   - register하는 것들은 모두 name을 써줘야한다
   
     => watch() 할때 object에 해당 name으로 나타남

```js
// Login.js
function Login() {
    const { register } = useForm(); 
}
...
<Input ref={register} name="username" type="text" placeholder="Username" />
<Input ref={register} name="password" type="password" placeholder="Password" />
```

💦 에러 : path.split is not a function(react-hook-form이 7.0.0이상으로 설치되어있을 때 나타남)

- `ref={register}` 를 다음과 같이 변경
  - `required:true`는 반드시 입력되어야 한다는 소리인듯

```js
<Input {...register('username', { required: true })} .../>
<Input {...register('password', { required: true })} .../>
```



3. **입력된 value들을 읽음 =>  watch**

   - state의 기능?

   -  username, password 입력값value의 변화를 watch

```js
const { register, watch } = useForm();
console.log(watch());
// => 입력값이 변화될때마다 콘솔 출력
```



4. **validation (useForm에 included)**

- username의 최대 글자 수 제한

```js
<Input {...register('username', { 
			required: true, 
			minLength:5, })}
```



5. **handleSubmit (도 useForm에 included)**

```js
const { register, watch, handleSubmit } = useForm();
```

- 두개의  argument를 받음(onSubmitValid, onSubmitInvalid)
  1. form이 valid하면 form이 valid한지 확인하는 function을 call
  2. form이 invalid하면 form이 invalid한지 확인하는 function을 call

```js
const onSubmitValid = (data) => {
    console.log(data);
}
const onSubmitInvalid = (data) => {
    console.log(data, "Invalid");
}
...
<form onSubmit={handleSubmit(onSubmitValid, onSubmitInvalid)}>
// form이 invalid하면 onSubmitInvalid 실행
```

- 에러메세지도 설정할 수 있음

```js
<Input
	{...register('password', {
		required: "Password is required.",
})}
```



6. **validation이 여러개인 경우**

- 조건이 여러개 ex. username에 "potato"를 포함하시오

```js
{...register('username', {
	...
    validate: async (currentValue) => currentValue.includes("potato")
})}
```

- async 를 사용할 수 있음 (사용자가 username을 입력하는 동시에 그것이 valid한지 백엔드에서 확인)

- regex 사용가능 : `pattern : ~`

  

### #10.8 React Hook Form is Awesome

- useForm은 에러도 제공해줌(버전 7.0.0이상에서 formState 내에 있음)
  - 입력과 동시에 즉각적으로 에러확인

```js
const { ... , formState } = useForm(){
    mode : "onChange",
};
console.log(formState.errors);
console.log(formState.isValid); // 폼이 유효한지 확인(boolean)
```

- **mode**

  onSubmit : submit한 시점에서 validation 검사

  onChange : 사용자가 input을 입력/삭제함에 따라

  onBlur : input에 무언가를 입력하고 다른 곳을 클릭(focus가 해제됨)

  onTouched : input을 클릭한 순간부터 validation 실행

- formState.isValid는 로그인버튼을 활성화/비활성화하는데 사용됨 => <Button>에 prop  전달

```js
<Button type="submit" value="Log in" disabled={!formState.isValid}/>
// formState가 invalid할 때 disabled
    
// Button.js
opacity: ${props => props.disabled ? "0.5" : "1"};
```

- **painting errors**

```js
<Input
{...register('password', {
    required: "Password is required.",
})}
...
/>
{formState.errors?.password?.message}
// errors가 존재하고, errors.password가 존재하는 경우 message를 보여줌(password input 밑에)
```

- FormError 컴포넌트로 만들기
  - margin있으면 error message가 존재하든 안하든 항상 그 자리를 차지함 => message가 empty string이거나 null인 경우에만 리턴

```js
// FormError.js
const SFormError = styled.span`
    color : tomato;
    font-weight : 600;
    font-size:12px;
    margin: 5px 0px 10px 0px;
`

function FormError({ message }) {
    return message === "" || !message ? null : <SFormError>{message}</SFormError>
}

```

- valid하지 않을 경우 input 상자에 표시하기
  - hasError prop 사용

```js
// Login
<Input 
	...
   	hasError = {Boolean(formState.errors?.password?.message)}
/>
```



```js
// Input.js
    border : ${(props) => (props.hasError ? "tomato" : props.theme.borderColor)};

```

